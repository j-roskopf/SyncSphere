platform :ios do

  lane :lint do
    swiftlint(
      mode: :lint,
      path: "iosApp/iosApp",
      strict: true,
      raise_if_swiftlint_error: true
    )
  end

  private_lane :build_sync_sphere do |options|
    xcversion(version: "15.0.1")
    match(
      app_identifier: ["com.joetr.sync.sphere"],
      type: options[:type] || "development"
    )
    build_app(
      workspace: "iosApp/iosApp.xcworkspace",
      scheme: options[:scheme],
      buildlog_path: "build/fastlane-buildlog",
      skip_package_ipa: false,
      skip_codesigning: false,
    )
  end

  lane :build do
    lint()
    build_sync_sphere(scheme: "iosApp")
  end

end


platform :ios do

  desc "Get certificates"
  lane :certificates do
    sync_code_signing(
      type: "development",
      app_identifier: ['com.joetr.sync.sphere'],
      force_for_new_devices: true,
      readonly: true
    )

    sync_code_signing(
      type: "appstore",
      app_identifier: 'com.joetr.sync.sphere',
      readonly: true
    )
  end

  desc "Generate new certificates"
  lane :generate_new_certificates do
    sync_code_signing(
      type: "development",
      app_identifier: ['com.joetr.sync.sphere'],
      force_for_new_devices: true,
      readonly: false
    )

    # You can repeate the sync_code_signing with other types of certificates such as appstore and adhoc

  end
end